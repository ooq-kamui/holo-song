
class Mmbr {

  static _mmbr = {
    
    "jp": {
      "00": {
        "sora": {
          "ch_id": "UCp6993wxpyDPHUpavwDFqgg",
          "tw_id": "tokino_sora",
          "flt_s": "ときのそら,sorasong"
        },
        "roboco": {
          "ch_id": "UCDqI2jOz0weumE8s7paEk6g",
          "tw_id": "robocosan",
          "flt_s": "ロボ子,ロボビタンA,roboco"
        },
        "azki": {
          "ch_id": "UC0TXe_LYZ4scaW2XMyi5_kw",
          "tw_id": "azki_vdiva",
          "flt_s": "azki"
        },
        "miko": {
          "ch_id": "UC-hM6YJuNYVAmUWxeIr9FeA",
          "tw_id": "sakuramiko35",
          "flt_s": "さくらみこ,micomet"
        },
        "suisei": {
          "ch_id": "UC5CwaMl1eIgY8h02uZw7u8A",
          "tw_id": "suisei_hosimati",
          "flt_s": "すいせい,suisei,micomet"
        },
      },
      "01": {
        "mel": {
          "ch_id": "UCD8HOxPs4Xvsm8H0ZxXGiBw",
          "tw_id": "yozoramel",
          "flt_s": "夜空メル,1期生"
        },
        "aki": {
          "ch_id": "UCFTLzh12_nrtzqBPsTCqenA",
          "tw_id": "akirosenthal",
          "flt_s": "アキロゼ,ローゼンタール,rosenthal,1期生"
        },
        "haato": {
          "ch_id": "UC1CfXB_kRs3C-zaeTG3oGyg",
          "tw_id": "akaihaato",
          "flt_s": "はあと,はあちゃま,haato,haachama,ロイちゃま,1期生"
        },
        "fubuki": {
          "ch_id": "UCdn5BQ06XqgXoAxIhbqw5Rg",
          "tw_id": "shirakamifubuki",
          "flt_s": "フブキ,fubuki,1期生"
        },
        "matsuri": {
          "ch_id": "UCQ0UDLQCjY0rmuxCDE38FGg",
          "tw_id": "natsuiromatsuri",
          "flt_s": "夏色まつり,1期生"
        },
      },
      "02": {
        "aqua": {
          "ch_id": "UC1opHUrw8rvnsadT-iGp7Cg",
          "tw_id": "minatoaqua",
          "flt_s": "湊あくあ,aqua"
        },
        "shion": {
          "ch_id": "UCXTpFs_3PqI41qX2d9tL2Rw",
          "tw_id": "murasakishionch",
          "flt_s": "紫咲シオン"
        },
        "ayame": {
          "ch_id": "UC7fk0CB07ly8oSl0aqKkqFg",
          "tw_id": "nakiriayame",
          "flt_s": "百鬼あやめ"
        },
        "choco": {
          "ch_id": "UC1suqwovbL1kzsoaZgFZLKg",
          "tw_id": "yuzukichococh",
          "flt_s": "癒月ちょこ"
        },
        "subaru": {
          "ch_id": "UCvzGlP9oQwU--Y0r9id_jnA",
          "tw_id": "oozorasubaru",
          "flt_s": "スバル"
        },
      },
      "gamers": {
        "mio": {
          "ch_id": "UCp-5t9SrOQwXMU7iIjQfARg",
          "tw_id": "ookamimio",
          "flt_s": "大神ミオ,さしみお"
        },
        "okayu": {
          "ch_id": "UCvaTdHTWBGv3MKj3KVqJVCw",
          "tw_id": "nekomataokayu",
          "flt_s": "猫又おかゆ,おかころ"
        },
        "korone": {
          "ch_id": "UChAnqc_AY5_I3Px5dig3X1Q",
          "tw_id": "inugamikorone",
          "flt_s": "戌神ころね,おかころ"
        },
      },
      "03": {
        "pekora": {
          "ch_id": "UC1DCedRgGHBdm81E1llLhOQ",
          "tw_id": "usadapekora",
          "flt_s": "兎田ぺこら,ホロライブファンタジー"
        },
        "flare": {
          "ch_id": "UCvInZx9h3jC2JzsIzoOebWg",
          "tw_id": "shiranuiflare",
          "flt_s": "不知火フレア,ホロライブファンタジー"
        },
        "noel": {
          "ch_id": "UCdyqAaZDKHXg4Ahi7VENThQ",
          "tw_id": "shiroganenoel",
          "flt_s": "白銀ノエル,ホロライブファンタジー"
        },
        "marine": {
          "ch_id": "UCCzUftO8KOVkV4wQG1vkUvg",
          "tw_id": "houshoumarine",
          "flt_s": "宝鐘マリン,ホロライブファンタジー"
        },
      },
      "04": {
        "kanata": {
          "ch_id": "UCZlDXzGoo7d44bwdNObFacg",
          "tw_id": "amanekanatach",
          "flt_s": "天音かなた,kanata,4期生,４期生"
        },
        "watame": {
          "ch_id": "UCqm3BQLlJfvkTsX_hvm0UmA",
          "tw_id": "tsunomakiwatame",
          "flt_s": "角巻わため,watame,回線,4期生,４期生"
        },
        "towa": {
          "ch_id": "UC1uv2Oq6kNxgATlCiez59hw",
          "tw_id": "tokoyamitowa",
          "flt_s": "常闇トワ,4期生,４期生"
        },
        "luna": {
          "ch_id": "UCa9Y57gfeY0Zro_noHRVrnw",
          "tw_id": "himemoriluna",
          "flt_s": "姫森ルーナ,4期生,４期生"
        },
      },
      "05": {
        "lamy": {
          "ch_id": "UCFKOVgVbGmX65RxO3EtH3iw",
          "tw_id": "yukihanalamy",
          "flt_s": "雪花ラミィ,ねぽらぼ,ほろふぁいぶ"
        },
        "nene": {
          "ch_id": "UCAWSyEs_Io8MtpY3m-zqILA",
          "tw_id": "momosuzunene",
          "flt_s": "桃鈴ねね,nene,ねぽらぼ,ほろふぁいぶ"
        },
        "botan": {
          "ch_id": "UCUKD-uaobj9jiqB-VXt71mA",
          "tw_id": "shishirobotan",
          "flt_s": "獅白ぼたん,ねぽらぼ,ほろふぁいぶ"
        },
        "polka": {
          "ch_id": "UCK9V2B22uJYu3N7eR_BT9QA",
          "tw_id": "omarupolka",
          "flt_s": "尾丸ポルカ,polka,ねぽらぼ,ほろふぁいぶ"
        },
      },
      "06": {
        "laplus": {
          "ch_id": "UCENwRMx5Yh42zWpzURebzTw",
          "tw_id": "laplusdarknesss",
          "flt_s": "ラプラス,6期生,holox"
        },
        "lui": {
          "ch_id": "UCs9_O1tRPMQTHQ-N_L6FU2g",
          "tw_id": "takanelui",
          "flt_s": "鷹嶺ルイ,6期生,holox"
        },
        "koyori": {
          "ch_id": "UC6eWCld0KwmyHFbAqK3V-Rw",
          "tw_id": "hakuikoyori",
          "flt_s": "博衣こより,6期生,holox"
        },
        "chloe": {
          "ch_id": "UCIBY1ollUsauvVi4hW4cumw",
          "tw_id": "sakamatachloe",
          "flt_s": "沙花叉クロヱ,6期生,holox"
        },
        "iroha": {
          "ch_id": "UC_vMYWcDjmfdpH6r4TTn1MQ",
          "tw_id": "kazamairohach",
          "flt_s": "風間いろは,6期生,holox"
        }
      }
    },
    "en": {
      "myth": {
        "calli": {
          "ch_id": "UCL_qhgtOy0dy1Agp8vkySQg",
          "tw_id": "moricalliope",
          "flt_s": "calliope,myth"
        },
        "kiara": {
          "ch_id": "UCHsx4Hqa-1ORjQTh9TYDhww",
          "tw_id": "takanashikiara",
          "flt_s": "kiara,myth"
        },
        "ina": {
          "ch_id": "UCMwGHR0BTZuLsmjY_NT5Pwg",
          "tw_id": "ninomaeinanis",
          "flt_s": "ina'nis,myth"
        },
        "gura": {
          "ch_id": "UCoSrY_IQQVpmIRZ9Xf-y93g",
          "tw_id": "gawrgura",
          "flt_s": "gura,myth"
        },
        "ame": {
          "ch_id": "UCyl1z3jo3XHR1riLFKG5UAg",
          "tw_id": "watsonameliaEN",
          "flt_s": "amelia,myth"
        }
      },
      "hope": {
        "irys": {
          "ch_id": "UC8rcEBzJSleTkf_-agPM20g",
          "tw_id": "irys_en",
          "flt_s": "irys"
        }
      },
      "council": {
        "fauna": {
          "ch_id": "UCO_aKKYxn4tvrqPjcTzZ6EQ",
          "tw_id": "ceresfauna",
          "flt_s": "fauna,council"
        },
        "kronii": {
          "ch_id": "UCmbs8T6MWqUHP1tIQvSgKrg",
          "tw_id": "ourokronii",
          "flt_s": "kronii,council"
        },
        "mumei": {
          "ch_id": "UC3n5uGu18FoCy23ggWWp8tA",
          "tw_id": "nanashimumei_en",
          "flt_s": "mumei,council"
        },
        "baelz": {
          "ch_id": "UCgmPnx-EEeOrZSg5Tiw7ZRQ",
          "tw_id": "hakosbaelz",
          "flt_s": "baelz,council"
        },
        "sana": {
          "ch_id": "UCsUj0dszADCGbF3gNrQEuSQ",
          "tw_id": "tsukumosana",
          "flt_s": "sana,council"
        }
      }
    },
    "id": {
      "01": {
        "risu": {
          "ch_id": "UCOyYb1c43VlX9rc_lT6NKQw",
          "tw_id": "ayunda_risu",
          "flt_s": "risu"
        },
        "moona": {
          "ch_id": "UCP0BspO_AMEe3aQqqpo89Dg",
          "tw_id": "moonahoshinova",
          "flt_s": "moona"
        },
        "iofi": {
          "ch_id": "UCAoy6rzhSf4ydcYjJw3WoVg",
          "tw_id": "airaniiofifteen",
          "flt_s": "iofi"
        }
      },
      "02": {
        "ollie": {
          "ch_id": "UCYz_5n-uDuChHtLo7My1HnQ",
          "tw_id": "kureijiollie",
          "flt_s": "ollie"
        },
        "anya": {
          "ch_id": "UC727SQYUvx5pDDGQpTICNWg",
          "tw_id": "anyamelfissa",
          "flt_s": "anya"
        },
        "reine": {
          "ch_id": "UChgTyjG-pdNvxxhdsXfHQ5Q",
          "tw_id": "pavoliareine",
          "flt_s": "reine"
        }
      },
      "03": {
        "zeta": {
          "ch_id": "UCTvHWSfBZgtxE4sILOaurIQ",
          "tw_id": "vestiazeta",
          "flt_s": "zeta"
        },
        "kaela": {
          "ch_id": "UCZLZ8Jjx_RN2CXloOmgTHVg",
          "tw_id": "kaelakovalskia",
          "flt_s": "kaela"
        },
        "kobo": {
          "ch_id": "UCjLEmnpCNeisMxy134KPwWw",
          "tw_id": "kobokanaeru",
          "flt_s": "kobo"
        }
      }
    }
  };
  
  static dly_time_over  = 400;
  static dly_time_leave = 500;
  
  constructor(is_panel){
    
    this._lst_elm;
    this._lst_dsp_elm = {};
    this._evnt_dly_id = {};
    
    this.lst_elm__init();
    
    if (is_panel){
      this.lst_dsp__init();
    }
  }
  
  lst_elm__init(){
  
    this.profile_elm__cre();
    
    this.lst_elm_evnt__add();
  }
  
  lst_elm_evnt__add(){
    
    let mmbr_lst_elm = elm('div.mmbr_lst');
    let _slf = this;
    
    mmbr_lst_elm.evnt__add(
      "mouseover",
      function (ev){
        // log("mouseover");

        _slf.evnt_dly(
          function (){ _slf.lst_elm__dsp(true); },
          Mmbr.dly_time_over
        );
      },
      false
    );

    mmbr_lst_elm.evnt__add(
      "mouseleave",
      function (ev){
        // log("mouseleave");
        
        _slf.evnt_dly(
          function (){ _slf.lst_elm__dsp(false); },
          Mmbr.dly_time_leave
        );
      },
      false
    );
  }
  
  profile_elm__cre(){
  
    let profile_elm_tmpl = elm('#profile_tmpl');
    let gen_elm_tmpl     = elm('#gen_tmpl');
    let mmbr_lst_elm     = elm('div.mmbr_lst');

    for (let [_cntry, cntry_mmbr] of Obj.entry(Mmbr._mmbr)){

      for (let [_gen, gen_mmbr] of Obj.entry(cntry_mmbr)){

        let gen_node    = gen_elm_tmpl.content.__clone(true);
        let gen_div_elm = gen_node.elm("div");
        
        gen_div_elm.attr__("id", Mmbr.gen_id(_cntry, _gen));

        for (let [name, profile] of Obj.entry(gen_mmbr)){

          let profile_node = profile_elm_tmpl.content.__clone(true);

          let a_elm;
          a_elm = profile_node.elm("a.mmbr_name");
          a_elm.textContent = name;
          a_elm.href = "../song/?o=cdt&f=ch_video/" + name + "/" + name + ".json";
          
          a_elm = profile_node.elm_all("a.icn");
          a_elm[0].href = "https://www.youtube.com/channel/" + profile.ch_id;
          a_elm[1].href = "https://twitter.com/" + profile.tw_id;
          
          a_elm = profile_node.elm("a.lnk_ch_video");
          a_elm.href = "../song/?o=cdt&f=ch_video/" + name + "/" + name + ".json";
          if (_cntry == "en" || _cntry == "id"){
            a_elm.attr__del("href")
            a_elm.attr__("tabindex", "-1")
          }
          
          a_elm = profile_node.elm("a.lnk_song_video");
          a_elm.href = "../song/?s=" + profile.flt_s

          let img_elm    = profile_node.elm("img.profile");
          img_elm.src = "../mmbr/" + _cntry + "/" + name + "/profile.jpg";
          
          // log(profile_node);
          
          gen_div_elm.__add(profile_node);
        }
        
        let div_profile = gen_div_elm.elm_all("div.profile");
        for (let [idx, _div_profile] of div_profile.entries()){

          let left = 130 * idx
          + (900 / 2)
          - (130 * div_profile.length / 2) + "px";
          // log(left);

          _div_profile.style.left = left;
        }
        
        mmbr_lst_elm.__add(gen_node);
      }
    }
  }
  
  lst_dsp__init(){
    
    let _slf = this;
    
    for (let [_cntry, cntry_mmbr] of Obj.entry(Mmbr._mmbr)){
      
      // dsp cntry evnt
      
      let lst_dsp_cntry_elm = this.lst_dsp_elm(_cntry);
      
      lst_dsp_cntry_elm.evnt__add(
        "mouseover",
        function (ev){
          // log("mouseover:" + _cntry);
          
          _slf.evnt_dly(
            function (){ _slf.lst_elm__dsp_cntry(_cntry); },
            Mmbr.dly_time_over
          );
        },
        false
      );
      
      lst_dsp_cntry_elm.evnt__add(
        "mouseleave",
        function (ev){
          // log("mouseleave");
          
          _slf.evnt_dly__cncl_all();
          
          _slf.evnt_dly(
            function (){ _slf.lst_elm__dsp(false); },
            Mmbr.dly_time_leave
          );
        },
        false
      );
      
      for (let [_gen  , gen_mmbr] of Obj.entry(cntry_mmbr)){
        
        let gen_id = Mmbr.gen_id(_cntry, _gen);
        
        let lst_dsp_elm = this.lst_dsp_elm(gen_id);
        
        lst_dsp_elm.evnt__add(
          "mouseover",
          function (ev){
            // log("mouseover:" + gen_id);
            
            _slf.evnt_dly(
              function (){ _slf.lst_elm__dsp_gen_id(gen_id); },
              Mmbr.dly_time_over
            );
          },
          false
        );
        
        lst_dsp_elm.evnt__add(
          "mouseleave",
          function (ev){
            // log("mouseleave");
            
            _slf.evnt_dly__cncl_all();
            
            _slf.evnt_dly(
              function (){ _slf.lst_elm__dsp(false); },
              Mmbr.dly_time_leave
            );
          },
          false
        );
      }
    }
    
    let lst_dsp_all_elm = this.lst_dsp_elm("all");
    
    lst_dsp_all_elm.evnt__add(
      "mouseover",
      function (evnt){
        // log("mouseover");

        _slf.evnt_dly(
          function (){ _slf.lst_elm__dsp_gen_all(); }, 
          Mmbr.dly_time_over
        );
      },
      false
    );
    
    lst_dsp_all_elm.evnt__add(
      "mouseleave",
      function (evnt){
        // log("mouseleave");
        
        _slf.evnt_dly__cncl_all();

        _slf.evnt_dly(
          function (){ _slf.lst_elm__dsp(false); }, 
          Mmbr.dly_time_leave
        );
      },
      false
    );
  }
  
  // 
  // evnt dly
  // 
  
  evnt_dly(fnc, time){
    
    this.evnt_dly__cncl_all();
    
    let evnt_dly_id = dly(fnc, time);
    
    this.evnt_dly_id__add(evnt_dly_id);
  }
  
  evnt_dly_id__add(evnt_dly_id){
    
    this._evnt_dly_id[evnt_dly_id] = true;
  }
  
  evnt_dly__cncl(evnt_dly_id){
    
    dly__cncl(evnt_dly_id);
    
    delete this._evnt_dly_id[evnt_dly_id]
  }
  
  evnt_dly__cncl_all(){
    
    for (let [_evnt_dly_id, _val] of Obj.entry(this._evnt_dly_id)){
      
      this.evnt_dly__cncl(_evnt_dly_id);
    }
  }
  
  // 
  // elm
  // 
  
  lst_elm(){
    
    if (this._lst_elm){ return this._lst_elm; }
    
    this.lst_elm__();
    
    return this._lst_elm;
  }
  
  lst_elm__(){
    
    this._lst_elm = elm("span.mmbr_lst");
  }
  
  lst_dsp_elm(gen_id){
    
    if (this._lst_dsp_elm[gen_id]){ return this._lst_dsp_elm[gen_id]; }
    
    this.lst_dsp_elm__(gen_id);
    
    return this._lst_dsp_elm[gen_id];
  }
  
  lst_dsp_elm__(gen_id){
    
    this._lst_dsp_elm[gen_id] = elm_by_id("mmbr_lst_dsp_" + gen_id);
  }
  
  // 
  // lst elm dsp
  // 
  
  lst_elm__dsp(flg){
    
    let opacity, visibility
    
    if (flg){
      opacity    = 1;
      visibility = "visible";
      
    }else{
      opacity    = 0;
      visibility = "hidden";
      
      this.lst_gen_elm__dsp_all(false);
    }
    
    let lst_elm = this.lst_elm();
    lst_elm.style.opacity    = opacity;
    lst_elm.style.visibility = visibility;
    
    // log(opacity, visibility, time);
  }
  
  lst_elm__dsp_gen_id(gen_id){
    
    this.lst_gen_elm__dsp_only(gen_id, true);
    
    this.lst_elm__dsp(true);
  }
  
  lst_elm__dsp_cntry(cntry){
    
    this.lst_gen_elm__dsp_cntry_only(cntry, true);
    
    this.lst_elm__dsp(true);
  }
  
  lst_elm__dsp_gen_all(){
    
    this.lst_gen_elm__dsp_all(true);
    
    this.lst_elm__dsp(true);
  }
  
  // 
  // lst gen dsp
  // 
  
  lst_gen_elm__dsp(gen_id, flg, plt_row){
    
    let div_profile = elm_all("#" + gen_id + " div.profile");
    
    for (let [idx, _div_profile] of div_profile.entries()){
        
      let anm, prm, prm_fin;
      let opt = {
        duration: 900,
        easing  : 'ease-in',
        fill    : 'forwards',
      };
      
      let mrgn_top =  30;
      let hdn_top  = 110;
      
      if (flg){
        prm = {
          top    : 100 * (plt_row - 1) + mrgn_top + "px",
          opacity: 1,
          visibility: "visible",
        };
        
        opt.easing = 'ease-in-out';
        
        anm = _div_profile.anm( [{}, prm], opt );
        
      }else{
        prm = {
          top    : hdn_top + mrgn_top + "px",
          opacity: 0,
          visibility: "hidden",
        };
        anm = _div_profile.anm( [{}, prm], opt );
      }
    }
  }
  
  lst_gen_elm__dsp_only(gen_id, flg){
    
    let plt_row = 0;
    
    for (let [_cntry, cntry_mmbr] of Obj.entry(Mmbr._mmbr)){
      
      for (let [_gen, gen_mmbr] of Obj.entry(cntry_mmbr)){
        
        let _flg;
        let _gen_id = Mmbr.gen_id(_cntry, _gen);
        
        _flg = (_gen_id == gen_id) ? flg : !flg ;
        
        if (_flg){ plt_row += 1; }
        
        this.lst_gen_elm__dsp(_gen_id, _flg, plt_row);
      }
    }
  }
  
  lst_gen_elm__dsp_cntry_only(cntry, flg){
    
    let plt_row = 0;
    
    for (let [_cntry, cntry_mmbr] of Obj.entry(Mmbr._mmbr)){
      
      let _flg = (_cntry == cntry) ? flg : !flg ;
      
      for (let [_gen, gen_mmbr] of Obj.entry(cntry_mmbr)){
        
        if (_flg){ plt_row += 1; }

        this.lst_gen_elm__dsp(Mmbr.gen_id(_cntry, _gen), _flg, plt_row);
      }
    }
  }
  
  lst_gen_elm__dsp_all(flg){
    
    let plt_row = 0;
    
    for (  let [_cntry, cntry_mmbr] of Obj.entry(Mmbr._mmbr)){
      for (let [_gen  , gen_mmbr  ] of Obj.entry(cntry_mmbr)){
        
        plt_row += 1;

        this.lst_gen_elm__dsp(Mmbr.gen_id(_cntry, _gen), flg, plt_row);
      }
    }
  }
  
  // 
  // static method
  // 
  
  static gen_id(cntry, gen){
    
    let gen_id = cntry + "_" + gen;
    return gen_id;
  }
}

let mmbr = new Mmbr(true);

